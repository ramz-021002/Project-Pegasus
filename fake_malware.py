#!/usr/bin/env python3
import socket
import os
import subprocess
import time

def main():
    print("--- Fake Malware Starting ---")
    
    # 1. File Operation: Create a file
    try:
        with open("dropped_file.txt", "w") as f:
            f.write("This is a dropped file.")
        print("Created dropped_file.txt")
    except Exception as e:
        print(f"Error creating file: {e}")

    # 2. Network Operation: DNS + Connect
    try:
        # This checks DNS resolution
        target_host = "google.com" 
        target_port = 80
        ip = socket.gethostbyname(target_host)
        print(f"Resolved {target_host} to {ip}")
        
        # Connect
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(5)
        s.connect((ip, target_port))
        s.send(b"GET / HTTP/1.1\r\nHost: google.com\r\n\r\n")
        data = s.recv(1024)
        print(f"Received {len(data)} bytes")
        s.close()
    except Exception as e:
        print(f"Error network: {e}")

    # 3. Process Execution
    try:
        subprocess.run(["ls", "-la"], check=True)
        print("Executed 'ls -la'")
    except Exception as e:
        print(f"Error executing command: {e}")

    print("--- Fake Malware Finished ---")

if __name__ == "__main__":
    main()
